"use strict";(()=>{var e={};e.id=836,e.ids=[836],e.modules={517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},7525:(e,t,r)=>{r.r(t),r.d(t,{headerHooks:()=>v,originalPathname:()=>A,patchFetch:()=>z,requestAsyncStorage:()=>S,routeModule:()=>f,serverHooks:()=>b,staticGenerationAsyncStorage:()=>w,staticGenerationBailout:()=>I});var a={};r.r(a),r.d(a,{OPTIONS:()=>y,POST:()=>g});var n=r(5419),i=r(9108),o=r(9678),s=r(8070),c=r(570),m=r(3883),l=r(4549),u=r(659);let d=[/bot/i,/crawler/i,/spider/i,/scraper/i,/curl/i,/wget/i,/python/i,/java/i,/php/i],p=["viagra","casino","lottery","click here","buy now","cheap","discount","offer","guaranteed","make money","work from home","investment","bitcoin","crypto","seo","marketing","insurance","loan"];async function g(e){let t=Date.now();try{let r;let a=e.ip??e.headers.get("x-forwarded-for")?.split(",")[0]?.trim()??"127.0.0.1",{success:n,limit:i,reset:o,remaining:g}=await m.LC.intake.limit(a);if(!n)return s.Z.json({error:"Rate limit exceeded. Please try again later.",code:"RATE_LIMIT_EXCEEDED"},{status:429,headers:{"X-RateLimit-Limit":i.toString(),"X-RateLimit-Remaining":g.toString(),"X-RateLimit-Reset":o.toString(),"Retry-After":"60"}});let y=e.headers.get("user-agent")||"";if(d.some(e=>e.test(y)))return s.Z.json({error:"Automated submissions are not allowed",code:"BOT_DETECTED"},{status:403});try{r=await e.json()}catch(e){return s.Z.json({error:"Invalid JSON payload",code:"INVALID_JSON"},{status:400})}let f=u.lC.safeParse(r);if(!f.success)return s.Z.json({error:"Invalid form data",code:"VALIDATION_ERROR",details:f.error.format()},{status:400});let S=f.data;if(!(0,l.sI)(S.email))return s.Z.json({error:"Please use a corporate email address. Personal email domains are not accepted.",code:"INVALID_EMAIL_DOMAIN",suggestions:["Use your company email (e.g., name@yourcompany.com)","Contact us directly for alternative submission methods"]},{status:400});let w=JSON.stringify(S).toLowerCase();if(p.some(e=>w.includes(e)))return s.Z.json({error:"Submission rejected",code:"SUBMISSION_REJECTED"},{status:400});if("hni"===S.companyType&&"50L-2Cr"===S.budgetRange)return s.Z.json({error:"Budget range does not match client type. Please adjust or contact us directly.",code:"BUDGET_MISMATCH"},{status:400});let b=process.env.ENCRYPTION_KEY;if(!b)throw Error("Server configuration error");let v={...S,metadata:{submittedAt:new Date().toISOString(),ip:a,userAgent:y.substring(0,100),processingTime:Date.now()-t,version:"1.0.0"}},I=(0,c.Gl)(v,b),A=await h(I,a);if(!A.success)throw Error("Failed to store intake data");return s.Z.json({success:!0,message:"Intake received and secured with military-grade encryption",referenceId:A.id,timestamp:new Date().toISOString(),nextSteps:["Our intelligence team will review your submission within 24 hours","You will receive an encrypted confirmation email","For urgent matters, contact our secure line"],security:{encryption:"AES-256-GCM",retention:"72 hours (automated deletion)",compliance:"ISO 27001, GDPR compliant"}},{status:200,headers:{"X-Content-Type-Options":"nosniff","X-Frame-Options":"DENY","X-XSS-Protection":"1; mode=block","Strict-Transport-Security":"max-age=31536000; includeSubDomains"}})}catch(e){return s.Z.json({error:"Internal server error",code:"INTERNAL_ERROR",message:"Please try again or contact support"},{status:500,headers:{"X-Error":"true"}})}}async function h(e,t){let r=`RF-${Date.now()}-${Math.random().toString(36).substr(2,9).toUpperCase()}`;return await new Promise(e=>setTimeout(e,100)),{success:!0,id:r,timestamp:new Date().toISOString(),storage:"encrypted_temporary_storage",purgeDate:new Date(Date.now()+2592e5).toISOString()}}function y(){return new s.Z(null,{status:204,headers:{"Access-Control-Allow-Methods":"POST, OPTIONS","Access-Control-Allow-Headers":"Content-Type, Authorization, X-Requested-With","Access-Control-Allow-Origin":"https://riskfortress.com","Access-Control-Max-Age":"86400","Access-Control-Allow-Credentials":"false"}})}let f=new n.AppRouteRouteModule({definition:{kind:i.x.APP_ROUTE,page:"/api/submit-intake/route",pathname:"/api/submit-intake",filename:"route",bundlePath:"app/api/submit-intake/route"},resolvedPagePath:"E:\\riskfortress\\src\\app\\api\\submit-intake\\route.ts",nextConfigOutput:"",userland:a}),{requestAsyncStorage:S,staticGenerationAsyncStorage:w,serverHooks:b,headerHooks:v,staticGenerationBailout:I}=f,A="/api/submit-intake/route";function z(){return(0,o.patchFetch)({serverHooks:b,staticGenerationAsyncStorage:w})}},570:(e,t,r)=>{r.d(t,{Gl:()=>s});let a=require("crypto");var n=r.n(a);let i="aes-256-gcm";class o{constructor(){}static getInstance(){return o.instance||(o.instance=new o),o.instance}deriveKey(e,t){return n().pbkdf2Sync(e,t,1e5,32,"sha512")}encrypt(e,t){try{let r=n().randomBytes(32),a=this.deriveKey(t,r),o=n().randomBytes(12),s=n().createCipheriv(i,a,o,{authTagLength:16}),c=JSON.stringify(e),m=Buffer.concat([s.update(c,"utf8"),s.final()]),l=s.getAuthTag();return{encrypted:m.toString("base64"),iv:o.toString("base64"),salt:r.toString("base64"),tag:l.toString("base64"),version:"1.0.0",timestamp:new Date().toISOString()}}catch(e){throw Error(`Encryption failed: ${e instanceof Error?e.message:"Unknown error"}`)}}decrypt(e,t){try{let r=Buffer.from(e.salt,"base64"),a=Buffer.from(e.iv,"base64"),o=Buffer.from(e.tag,"base64"),s=Buffer.from(e.encrypted,"base64"),c=this.deriveKey(t,r),m=n().createDecipheriv(i,c,a,{authTagLength:16});m.setAuthTag(o);let l=m.update(s);l=Buffer.concat([l,m.final()]);let u=JSON.parse(l.toString("utf8")),d=this.verifyIntegrity(u,e);return{decrypted:u,verified:d,timestamp:e.timestamp}}catch(e){throw Error(`Decryption failed: ${e instanceof Error?e.message:"Unknown error"}`)}}verifyIntegrity(e,t){try{let e=new Date(t.timestamp);if(new Date().getTime()-e.getTime()>864e5||"1.0.0"!==t.version)return!1;return!0}catch{return!1}}async rotateKey(e,t,r){try{let a=this.decrypt(r,e);if(!a.verified)throw Error("Data integrity verification failed");return this.encrypt(a.decrypted,t)}catch(e){throw Error(`Key rotation failed: ${e instanceof Error?e.message:"Unknown error"}`)}}generateKey(){return n().randomBytes(32).toString("base64")}hashData(e){let t=JSON.stringify(e);return n().createHash("sha256").update(t).digest("hex")}}function s(e,t){return JSON.stringify(o.getInstance().encrypt(e,t))}},3883:(e,t,r)=>{r.d(t,{LC:()=>i});let a=new Map,n=(e,t)=>({async limit(r){let n=Date.now(),i=a.get(r);return!i||n>i.resetAt?(a.set(r,{count:1,resetAt:n+t}),{success:!0,limit:e,remaining:e-1,reset:n+t}):i.count>=e?{success:!1,limit:e,remaining:0,reset:i.resetAt}:(i.count++,{success:!0,limit:e,remaining:e-i.count,reset:i.resetAt})}});n(10,6e4);let i={intake:n(5,6e4),contact:n(10,3e5),api:n(100,6e4)}},4549:(e,t,r)=>{r.d(t,{sI:()=>i});let a=[/@[a-zA-Z0-9-]+\.(co\.in|in|com|org|net)$/i,/@[a-zA-Z0-9-]+\.(com|org|net|io|ai|co|uk|de|fr|jp)$/i,/@(?!gmail|yahoo|outlook|hotmail|aol|icloud|protonmail|zoho|rediff|indiatimes)\.[a-z]{2,}$/i],n=["gmail.com","yahoo.com","outlook.com","hotmail.com","aol.com","icloud.com","protonmail.com","zoho.com","rediffmail.com","indiatimes.com","mail.com","gmx.com","yandex.com","qq.com","163.com","126.com"];function i(e){if(!e)return!1;let t=e.toLowerCase();if(n.some(e=>t.endsWith(`@${e}`))||!a.some(e=>e.test(t)))return!1;if([/^info@/,/^contact@/,/^support@/,/^admin@/,/^hello@/,/^test@/].some(e=>e.test(t))){let e=t.split("@")[1];if(!["corp","inc","llc","ltd","pvt","private","limited","industries","group","holdings","enterprise","security","intelligence"].some(t=>e.includes(t)))return!1}return!!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(t)}},659:(e,t,r)=>{r.d(t,{lC:()=>o});var a=r(2196);let n=a.z.string().email("Invalid email address").refine(e=>{let t=e.split("@")[1];return!["gmail.com","yahoo.com","outlook.com","hotmail.com","aol.com","icloud.com","protonmail.com","zoho.com"].includes(t?.toLowerCase())},"Please use a corporate email address"),i=a.z.string().regex(/^[6-9]\d{9}$/,"Invalid Indian phone number").or(a.z.string().regex(/^\+91[6-9]\d{9}$/,"Invalid Indian phone number")),o=a.z.object({firstName:a.z.string().min(2,"First name must be at least 2 characters").max(50,"First name must be less than 50 characters").regex(/^[a-zA-Z\s]+$/,"First name can only contain letters"),lastName:a.z.string().min(2,"Last name must be at least 2 characters").max(50,"Last name must be less than 50 characters").regex(/^[a-zA-Z\s]+$/,"Last name can only contain letters"),company:a.z.string().min(2,"Company name is required").max(100,"Company name must be less than 100 characters"),jobTitle:a.z.string().min(2,"Job title is required").max(100,"Job title must be less than 100 characters"),email:n,phone:i,companyType:a.z.enum(["fortune500","industrial","familyOffice","hni","government","other"],{errorMap:()=>({message:"Invalid company type"})}),budgetRange:a.z.enum(["50L-2Cr","2Cr-10Cr","10Cr-50Cr","50Cr+","custom"],{errorMap:()=>({message:"Invalid budget range"})}),primaryConcern:a.z.enum(["landDueDiligence","tscmServices","familySecurity","riskManagement","intelligence","executiveProtection","industrialSecurity","other"],{errorMap:()=>({message:"Invalid concern selection"})}),message:a.z.string().min(20,"Please provide more details (minimum 20 characters)").max(2e3,"Message must be less than 2000 characters").optional().or(a.z.literal("")),agreeToTerms:a.z.literal(!0,{errorMap:()=>({message:"You must agree to the terms"})}),honeypot:a.z.string().max(0,"Spam detected").optional()});o.partial(),a.z.object({name:a.z.string().min(2).max(100),email:n,company:a.z.string().min(2).max(100),subject:a.z.string().min(5).max(200),message:a.z.string().min(20).max(2e3)}),a.z.object({email:n,consent:a.z.literal(!0),interests:a.z.array(a.z.string()).optional()}),a.z.object({name:a.z.string(),type:a.z.string().regex(/^application\/(pdf|msword|vnd\.openxmlformats-officedocument\.wordprocessingml\.document)$/),size:a.z.number().max(10485760)})}};var t=require("../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),a=t.X(0,[638,406],()=>r(7525));module.exports=a})();